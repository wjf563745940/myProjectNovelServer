{"version":3,"sources":["webpack:///static/js/9.af9884fbc375390cc3db.js","webpack:///./src/views/info/novelListLocal.vue","webpack:///./src/util/pounchDbUtil.js?0982*","webpack:///novelListLocal.vue","webpack:///./src/views/info/novelListLocal.vue?49dc","webpack:///./src/views/info/novelListLocal.vue?a51f","webpack:///./src/views/info/novelListLocal.vue?7ece"],"names":["webpackJsonp","206","module","exports","__webpack_require__","Component","221","__webpack_exports__","initDB","dbname","dbnames","db","PouchDB","console","log","addData","data","post","getById","id","get","putData","put","mulPutDatas","keys","datas","prefix","keysflag","Object","prototype","toString","call","iddatas","map","item","idstr","forEach","it","index","_id","bulkDocs","pounchDbUtil","235","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","n","__WEBPACK_IMPORTED_MODULE_1_axios__","__WEBPACK_IMPORTED_MODULE_2_vuex__","__WEBPACK_IMPORTED_MODULE_3_util_indexedDb__","__WEBPACK_IMPORTED_MODULE_4_util_pounchDbUtil__","name","infoLists","keyPath","myDb","osname","computed","i","getVersion","created","that","this","getPounchDbNovel","methods","allDocs","include_docs","attachments","then","rows","length","newdata","doc","downstatue","getAllNovel","fetchStoreByCursor","close","filter","downloadnovel","$router","push","getNovel","novel","novelId","getDataByIndex","currentChapter","infoDetail","initDb","v","setDbVersion","openDb","setNovel","248","version","sources","names","mappings","file","sourcesContent","sourceRoot","253","content","locals","261","render","_vm","_h","$createElement","_c","_self","staticClass","_l","attrs","on","click","$event","_v","_s","type","stopPropagation","preventDefault","staticRenderFns"],"mappings":"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","file":"static/js/9.af9884fbc375390cc3db.js","sourcesContent":["webpackJsonp([9],{\n\n/***/ 206:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(253)\n\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(235),\n  /* template */\n  __webpack_require__(261),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 221:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar pounchDbUtil = {\n    initDB: initDB,\n\n    addData: addData,\n    putData: putData,\n    getById: getById,\n    mulPutDatas: mulPutDatas\n};\nfunction initDB(dbname) {\n    var dbnames = dbname ? dbname : \"novel\";\n    var db = new PouchDB(dbnames);\n    console.log(\"init pounchdb\");\n    return db;\n};\nfunction addData(db, data) {\n    return db.post(data);\n};\nfunction getById(db, id) {\n    return db.get(id);\n}\nfunction putData(db, id, data) {\n    data['_id'] = id;\n    return db.put(data);\n}\nfunction mulPutDatas(db, keys, datas, prefix) {\n\n    var keysflag = false;\n    if (Object.prototype.toString.call(keys) === '[object Array]') {\n\n        keysflag = true;\n    }\n    var iddatas = datas.map(function (item) {\n        var idstr = \"\";\n        if (keysflag) {\n            keys.forEach(function (it, index) {\n                idstr += (prefix ? prefix[index] : '') + item[it];\n            });\n        } else {\n            idstr = (prefix ? prefix : '') + item[keys];\n        }\n        item._id = idstr;\n        return item;\n    });\n    console.log(iddatas);\n    return db.bulkDocs(iddatas);\n}\n\nfunction updateData(db, id, data) {\n    db.get(id).then(function (doc) {\n        return db.put(data);\n    }).catch(function (err) {\n        console.log(err);\n    });\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (pounchDbUtil);\n\n/***/ }),\n\n/***/ 235:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_axios__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_axios___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_axios__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_vuex__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_util_indexedDb__ = __webpack_require__(76);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_util_pounchDbUtil__ = __webpack_require__(221);\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n\tname: 'ruleList',\n\tdata: function data() {\n\t\treturn {\n\t\t\tinfoLists: [],\n\t\t\tkeyPath: \"id\",\n\t\t\tmyDb: {},\n\t\t\tosname: \"novels\"\n\n\t\t};\n\t},\n\n\tcomputed: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_vuex__[\"b\" /* mapGetters */])({\n\t\t\"getVersion\": \"getVersion\"\n\t})),\n\tcreated: function created() {\n\t\tvar that = this;\n\n\t\tthat.myDb = __WEBPACK_IMPORTED_MODULE_4_util_pounchDbUtil__[\"a\" /* default */].initDB(\"novel\");\n\t\tthat.getPounchDbNovel();\n\t},\n\tmethods: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({\n\t\tgetPounchDbNovel: function getPounchDbNovel() {\n\t\t\tvar that = this;\n\t\t\tthat.myDb.allDocs({\n\t\t\t\tinclude_docs: true,\n\t\t\t\tattachments: true\n\t\t\t}).then(function (data) {\n\t\t\t\tconsole.log(data);\n\t\t\t\tif (data.rows.length !== 0) {\n\t\t\t\t\tvar newdata = data.rows.map(function (item, index) {\n\t\t\t\t\t\tif (item.doc.downstatue) {\n\t\t\t\t\t\t\treturn item.doc;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthat.infoLists = newdata;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetAllNovel: function getAllNovel() {\n\t\t\tvar that = this;\n\t\t\tconsole.log(\"data\", that.infoLists);\n\t\t\t__WEBPACK_IMPORTED_MODULE_3_util_indexedDb__[\"a\" /* default */].fetchStoreByCursor(that.myDb.db, that.osname, function (data) {\n\t\t\t\tthat.myDb.db.close();\n\t\t\t\tconsole.log(\"data\", data);\n\t\t\t\tif (data.length === 0) {} else {\n\t\t\t\t\tvar newdata = data.filter(function (item, index) {\n\t\t\t\t\t\treturn item.downstatue;\n\t\t\t\t\t});\n\t\t\t\t\tthat.infoLists = newdata;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdownloadnovel: function downloadnovel(index) {\n\t\t\tthis.$router.push(\"/novelMenuDownload?novelId=\" + this.infoLists[index].id);\n\t\t},\n\t\tgetNovel: function getNovel(index) {\n\t\t\tvar that = this;\n\t\t\tvar novel = that.infoLists[index];\n\t\t\tvar novelId = novel.id;\n\t\t\t__WEBPACK_IMPORTED_MODULE_3_util_indexedDb__[\"a\" /* default */].getDataByIndex(that.myDb.db, that.osname, novelId, that.keyPath, function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tthat.myDb.db.close();\n\t\t\t\t\tthat.$router.push(\"/novelList/detail?novelId=\" + novelId + \"&novelChapterId=\" + data.currentChapter);\n\t\t\t\t} else {\n\t\t\t\t\tnovel.currentChapter = 1;\n\t\t\t\t\t__WEBPACK_IMPORTED_MODULE_3_util_indexedDb__[\"a\" /* default */].addData(that.myDb.db, that.osname, [novel]);\n\t\t\t\t\tthat.myDb.db.close();\n\t\t\t\t\tthat.$router.push(\"/novelList/detail?novelId=\" + novelId + \"&novelChapterId=1\");\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tinfoDetail: function infoDetail(index) {\n\t\t\tvar that = this;\n\t\t\tvar novelId = this.infoLists[index].id;\n\t\t\t__WEBPACK_IMPORTED_MODULE_3_util_indexedDb__[\"a\" /* default */].initDb(\"novel\", that.getVersion + 1, function (v) {\n\t\t\t\tthat.setDbVersion(v);\n\t\t\t\tvar request = __WEBPACK_IMPORTED_MODULE_3_util_indexedDb__[\"a\" /* default */].openDb(\"novel\", that.osname, that.getVersion + 1, that.keyPath, that.myDb, function () {\n\t\t\t\t\tthat.getNovel(index);\n\t\t\t\t\tthat.setDbVersion(that.getVersion + 1);\n\t\t\t\t});\n\t\t\t}, function () {\n\t\t\t\tthat.getNovel(index);\n\t\t\t\tthat.setDbVersion(that.getVersion + 1);\n\t\t\t}, that.osname, that.keyPath, that.myDb);\n\t\t}\n\t}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2_vuex__[\"c\" /* mapActions */])({\n\t\t\"setNovel\": \"setNovel\",\n\t\t\"setDbVersion\": \"setDbVersion\"\n\t}))\n});\n\n/***/ }),\n\n/***/ 248:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(203)(true);\n// imports\n\n\n// module\nexports.push([module.i, \".desc button{float:right;border:1px;background:#26a2ff;color:#fff;padding:6 12px}\", \"\", {\"version\":3,\"sources\":[\"G:/work/my-project-novel/src/views/info/novelListLocal.vue\"],\"names\":[],\"mappings\":\"AACA,aACC,YAAa,AACb,WAAY,AACZ,mBAAoB,AACpB,WAAY,AACZ,cAAgB,CAChB\",\"file\":\"novelListLocal.vue\",\"sourcesContent\":[\"\\n.desc  button{\\n\\tfloat: right;\\n\\tborder: 1px;\\n\\tbackground: #26a2ff;\\n\\tcolor: #fff;\\n\\tpadding: 6 12px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 253:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(248);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(204)(\"78c70301\", content, true);\n\n/***/ }),\n\n/***/ 261:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('div', {\n    staticClass: \"_full_inner _scroll _effect component-chat\"\n  }, [_c('ul', {\n    staticClass: \"wechat-list\"\n  }, _vm._l((_vm.infoLists), function(item, index) {\n    return _c('li', {\n      staticClass: \"item _line-fine chat-item-transition\"\n    }, [_c('div', {\n      staticClass: \"info\",\n      attrs: {\n        \"index\": index\n      },\n      on: {\n        \"click\": function($event) {\n          _vm.infoDetail(index)\n        }\n      }\n    }, [_c('div', {\n      staticClass: \"desc\"\n    }, [_c('span', [_vm._v(_vm._s(item.name))]), _vm._v(\" \"), _c('button', {\n      attrs: {\n        \"type\": \"button\",\n        \"index\": index\n      },\n      on: {\n        \"click\": function($event) {\n          $event.stopPropagation();\n          $event.preventDefault();\n          _vm.downloadnovel(index)\n        }\n      }\n    }, [_vm._v(\"下载\")])])])])\n  }))]), _vm._v(\" \"), _c('transition', {\n    attrs: {\n      \"name\": \"slide-right\"\n    }\n  }, [_c('router-view', {\n    staticClass: \"cover-transition\"\n  })], 1)], 1)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/9.af9884fbc375390cc3db.js","\n/* styles */\nrequire(\"!!../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-62a502ac\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./novelListLocal.vue\")\n\nvar Component = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./novelListLocal.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62a502ac\\\"}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./novelListLocal.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/info/novelListLocal.vue\n// module id = 206\n// module chunks = 9","var pounchDbUtil={\r\n\t\t\tinitDB: initDB,\r\n           // getAllBirthdays: getAllBirthdays,\r\n            addData: addData,\r\n            putData:putData,\r\n            getById:getById,\r\n            mulPutDatas:mulPutDatas\r\n           // updateBirthday: updateBirthday,\r\n          //  deleteBirthday: deleteBirthday\r\n}\r\n function initDB(dbname) {\r\n            // Creates the database or opens if it already exists\r\n            var dbnames=dbname?dbname:\"novel\";\r\n            var db = new PouchDB(dbnames);\r\n            console.log(\"init pounchdb\")\r\n            return db;\r\n        };\r\n        function addData(db,data) {\r\n            return  db.post(data);\r\n        };\r\n        function getById(db,id){\r\n          return db.get(id);\r\n        }\r\n        function putData(db,id,data){\r\n          //  if(data){\r\n               data['_id']=id;\r\n            return db.put(data); \r\n           // }\r\n            \r\n        }\r\n        function mulPutDatas(db,keys,datas,prefix){\r\n           // data['_id']=prefix?prefix:''+datas[key];\r\n           \r\n        var keysflag=false;\r\n        if( Object.prototype.toString.call(keys)==='[object Array]'){\r\n            \r\n            keysflag=true;\r\n        }\r\n         var iddatas=  datas.map(function(item){\r\n            var idstr=\"\";\r\n            if(keysflag){\r\n                keys.forEach(function(it,index){\r\n                    idstr+=(prefix?prefix[index]:'')+item[it]\r\n                 })\r\n            }else{\r\n                idstr=(prefix?prefix:'')+item[keys];\r\n                \r\n            }\r\n            item._id=idstr;\r\n             return item\r\n        })\r\n         console.log(iddatas)\r\n            return db.bulkDocs(iddatas); \r\n        }\r\n        \r\n        function updateData(db,id,data ){\r\n            db.get(id).then(function(doc) {\r\n             return db.put(data);\r\n            }).catch(function (err) {\r\n              console.log(err);\r\n            });\r\n        }\r\n\r\n        export default pounchDbUtil\n\n\n// WEBPACK FOOTER //\n// ./src/util/pounchDbUtil.js","\t<template>\r\n\t<div>\r\n\t\t<div class=\"_full_inner _scroll _effect component-chat\" >\r\n\t\t<ul class=\"wechat-list\">\r\n\t\t\t<li class=\"item _line-fine chat-item-transition\" v-for=\"(item ,index) in infoLists\">\r\n\t\t\t\t<div v-bind:index=\"index\" class=\"info\" v-on:click=\"infoDetail(index)\">\r\n\t\t\t\t<div class=\"desc\">\r\n\t\t\t\t\t<span>{{item.name}}</span>\r\n\t\t\t\t\t<button type=\"button\" v-bind:index=\"index\"  @click.stop.prevent=\"downloadnovel(index)\">下载</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t\t\r\n\t\t</div>\r\n\t\t<!-- children router-->\r\n\t\t <transition name=\"slide-right\">\r\n\t\t<router-view class=\"cover-transition\"></router-view>\r\n\t\t</transition>\r\n    </div>\r\n\t</template>\r\n\t<script>\r\n\timport axios from 'axios'\r\n\timport {mapGetters,mapActions} from 'vuex'\r\n\timport indexedDb from 'util/indexedDb'\r\n\timport pounchDbUtil from 'util/pounchDbUtil'\r\n\texport default{\r\n\tname:'ruleList',\r\n\tdata () {\r\n\t\treturn {\r\n\t\t\tinfoLists:[\r\n\t\t\t],\r\n\t\t\tkeyPath:\"id\",\r\n\t\t\tmyDb:{},\r\n\t\t\tosname:\"novels\"\r\n\r\n\t\t}\r\n\t},\r\n\tcomputed:{\r\n\t\t...mapGetters({\r\n\t\t\t\t  \"getVersion\":\"getVersion\",\r\n\t\t\t\t  })\r\n\t},\r\n\t created:function(){\r\n      let that=this;\r\n  \t\t\t\t\t\t// indexedDb.initDb(\"novel\",that.getVersion+1,function(v){//opensuccess里嵌套open不行\r\n  \t\t\t\t\t\t// \t  that.setDbVersion(v);\r\n  \t\t\t\t\t\t// \tvar request=indexedDb.openDb(\"novel\",that.osname,that.getVersion+1,that.keyPath,that.myDb,function(){\r\n  \t\t\t\t\t\t// \t\t\tthat.getAllNovel();\r\n\t\t\t\t\t\t\t\t// \tthat.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t// \t//that.myDb.db.close();\t\t\t   \r\n\t\t\t\t\t   //     });//打开本地数据库//让ob跟书id绑定\r\n\t\t\t\t\t      \t \r\n\r\n  \t\t\t\t\t\t// },function(){\r\n  \t\t\t\t\t\t// \tthat.getAllNovel();\r\n  \t\t\t\t\t\t// \tthat.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t// \t//that.myDb.db.close();\r\n  \t\t\t\t\t\t// \t   that.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t// },that.osname,that.keyPath,that.myDb)\t\r\n  \t\t\t\t\t\tthat.myDb=pounchDbUtil.initDB(\"novel\");\r\n  \t\t\t\t\t\tthat.getPounchDbNovel();\r\n\r\n    },\r\n\tmethods:{\r\n\t\tgetPounchDbNovel:function(){\r\n\t\t\tlet that=this;\r\n\t\t\tthat.myDb.allDocs({\r\n\t\t\t  include_docs: true,\r\n\t\t\t  attachments: true\r\n\t\t\t}).then(function(data){\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t\tif(data.rows.length!==0){\r\n\t\t\t\t\tvar newdata=data.rows.map(function(item,index){\r\n\t\t\t\t\t\tif(item.doc.downstatue){\r\n\t\t\t\t\t\t\treturn item.doc;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\tthat.infoLists=newdata;\r\n\t\t\t\t}\r\n\r\n\t\t\t})\r\n\t\t},\r\n\t\tgetAllNovel:function(){\r\n\t\t\tlet that=this;\r\n\t\t\tconsole.log(\"data\",that.infoLists)\r\n\t\t\tindexedDb.fetchStoreByCursor(that.myDb.db,that.osname,function(data){\r\n\t\t\t\t\t\tthat.myDb.db.close();\r\n\t\t\t\t\t\tconsole.log(\"data\",data)\r\n\t\t\t\t\t\tif(data.length===0){\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tvar newdata=data.filter(function(item,index){\r\n\t\t\t\t\t\t\t\treturn item.downstatue\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthat.infoLists=newdata;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t},\r\n\t\tdownloadnovel:function(index){\r\n\t\t\t    \tthis.$router.push(\"/novelMenuDownload?novelId=\"+this.infoLists[index].id);\r\n\t\t\t    \t\r\n\t\t},\r\n\t\tgetNovel:function(index){\r\n\t\t\tlet that=this;\r\n\t\t\tlet novel=that.infoLists[index];\r\n\t\t\tlet novelId=novel.id;\r\n\t\t\tindexedDb.getDataByIndex(that.myDb.db,that.osname,novelId,that.keyPath,function(data){\r\n\t\t\t\tif(data){\r\n\t\t\t\t\tthat.myDb.db.close();\r\n\t\t\t\t\tthat.$router.push(\"/novelList/detail?novelId=\"+novelId+\"&novelChapterId=\"+data.currentChapter);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tnovel.currentChapter=1;\r\n\t\t\t\t\t  indexedDb.addData(that.myDb.db,that.osname,[novel]);\r\n\t\t\t\t\t  that.myDb.db.close();\r\n\t\t\t\t\t  that.$router.push(\"/novelList/detail?novelId=\"+novelId+\"&novelChapterId=1\");\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t})\r\n\t\t},\r\n\t\tinfoDetail:function(index){\r\n\t\t\tlet that = this;\r\n\t\t\t\t\t\tlet novelId=this.infoLists[index].id;\r\n  \t\t\t\t\t\tindexedDb.initDb(\"novel\",that.getVersion+1,function(v){//opensuccess里嵌套open不行\r\n  \t\t\t\t\t\t\t  that.setDbVersion(v);\r\n  \t\t\t\t\t\t\tvar request=indexedDb.openDb(\"novel\",that.osname,that.getVersion+1,that.keyPath,that.myDb,function(){\r\n\t\t\t\t\t       \t\t\tthat.getNovel(index);\r\n\t\t\t\t\t\t\t\t\tthat.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t\t//that.myDb.db.close();\t\t\t   \r\n\t\t\t\t\t       });//打开本地数据库//让ob跟书id绑定\r\n\t\t\t\t\t      \t \r\n\r\n  \t\t\t\t\t\t},function(){\r\n  \t\t\t\t\t\t\tthat.getNovel(index);\r\n  \t\t\t\t\t\t\tthat.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t\t//that.myDb.db.close();\r\n  \t\t\t\t\t\t\t  // that.setDbVersion(that.getVersion+1); \r\n  \t\t\t\t\t\t},that.osname,that.keyPath,that.myDb)\t\r\n\r\n\r\n\t\t\t\r\n\t\t},\r\n\t\t...mapActions({\r\n\t\t\t\t\"setNovel\":\"setNovel\",\r\n\t\t\t\t   \"setDbVersion\":\"setDbVersion\"\r\n\t\t\t})\r\n\t}\r\n}\r\n\t</script>\r\n\t<style scope>\r\n\t.desc  button{\r\n\t\tfloat: right;\r\n\t\tborder: 1px;\r\n\t\tbackground: #26a2ff;\r\n\t\tcolor: #fff;\r\n\t\tpadding: 6 12px;\r\n\t}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// novelListLocal.vue?578c64d9","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".desc button{float:right;border:1px;background:#26a2ff;color:#fff;padding:6 12px}\", \"\", {\"version\":3,\"sources\":[\"G:/work/my-project-novel/src/views/info/novelListLocal.vue\"],\"names\":[],\"mappings\":\"AACA,aACC,YAAa,AACb,WAAY,AACZ,mBAAoB,AACpB,WAAY,AACZ,cAAgB,CAChB\",\"file\":\"novelListLocal.vue\",\"sourcesContent\":[\"\\n.desc  button{\\n\\tfloat: right;\\n\\tborder: 1px;\\n\\tbackground: #26a2ff;\\n\\tcolor: #fff;\\n\\tpadding: 6 12px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-62a502ac\",\"scoped\":false,\"hasInlineConfig\":false}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/views/info/novelListLocal.vue\n// module id = 248\n// module chunks = 9","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"id\\\":\\\"data-v-62a502ac\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./novelListLocal.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"78c70301\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/vue-style-loader!./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-62a502ac\",\"scoped\":false,\"hasInlineConfig\":false}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/views/info/novelListLocal.vue\n// module id = 253\n// module chunks = 9","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('div', {\n    staticClass: \"_full_inner _scroll _effect component-chat\"\n  }, [_c('ul', {\n    staticClass: \"wechat-list\"\n  }, _vm._l((_vm.infoLists), function(item, index) {\n    return _c('li', {\n      staticClass: \"item _line-fine chat-item-transition\"\n    }, [_c('div', {\n      staticClass: \"info\",\n      attrs: {\n        \"index\": index\n      },\n      on: {\n        \"click\": function($event) {\n          _vm.infoDetail(index)\n        }\n      }\n    }, [_c('div', {\n      staticClass: \"desc\"\n    }, [_c('span', [_vm._v(_vm._s(item.name))]), _vm._v(\" \"), _c('button', {\n      attrs: {\n        \"type\": \"button\",\n        \"index\": index\n      },\n      on: {\n        \"click\": function($event) {\n          $event.stopPropagation();\n          $event.preventDefault();\n          _vm.downloadnovel(index)\n        }\n      }\n    }, [_vm._v(\"下载\")])])])])\n  }))]), _vm._v(\" \"), _c('transition', {\n    attrs: {\n      \"name\": \"slide-right\"\n    }\n  }, [_c('router-view', {\n    staticClass: \"cover-transition\"\n  })], 1)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-62a502ac\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/views/info/novelListLocal.vue\n// module id = 261\n// module chunks = 9"],"sourceRoot":""}